# Web RTMP Streamer - TODO

## 설정 화면 및 RTMP 연결
- [x] RTMP 서버 URL 입력 필드
- [x] 스트림키 입력 필드
- [x] 연결 설정 저장 기능

## 웹캠 기능
- [x] 웹캠 캡처 기능 구현
- [x] 웹캠 회전 기능 (0°, 90°, 180°, 270°)
- [x] 카메라 선택 드롭다운

## 영상 재생목록 관리
- [x] 로컬 영상 파일 업로드 기능
- [x] 재생목록 추가/삭제 기능
- [x] 재생목록 순서 변경 (위/아래 버튼)
- [x] 무한 반복 재생 기능

## 미디어 플레이어 컨트롤
- [x] 재생/일시정지 버튼
- [x] 타임라인 조절 슬라이더
- [x] 음량 조절 슬라이더

## Canvas 합성 엔진
- [x] 9:16 세로 비율 Canvas 생성
- [x] 캠 전체 모드 구현
- [x] 자료화면 전체 모드 구현
- [x] 합성모드1 (자료 16:9 상단 + 캠 4:3 하단 + 검은 여백)
- [x] 합성모드2 (자료 16:9 상단 + 캠 나머지 영역 꽉채움)
- [x] 자료화면과 캠 사이 20px 검은색 여유 공간

## RTMP 송출
- [x] 서버 측 RTMP 중계 기능 (ffmpeg)
- [x] 클라이언트 WebSocket 연결
- [x] Canvas 스트림을 MediaStream으로 변환
- [x] 방송 시작/중지 컨트롤
- [x] 실시간 방송 상태 표시

## UI 개선
- [x] 2열 레이아웃으로 변경 (왼쪽: RTMP설정/미리보기/합성모드, 오른쪽: 웹캠/재생목록/플레이어)

## UI 개선 2차
- [x] 화면 합성 모드 - CAM/VIDEO 블록 위치 맞추기
- [x] 화면 합성 모드 - 16:9 초록색 박스 사실적 비율로 수정
- [x] 모든 카드의 제목-내용 여백 50% 이상 줄이기
- [x] 재생목록 - 다음 영상 자동 재생 기능
- [x] 재생목록 - 버튼을 제목 왼쪽에 배치
- [x] 재생목록 - 제목 줄바꿈 허용
- [x] 전체 콘텐츠 최대 너비 800px 제한

## 에러 처리 개선
- [x] 스트림 종료 시 발생하는 정상적인 메시지를 에러가 아닌 종료 상태로 처리
- [x] 서버 측 연결 끊김 시 클라이언트에서 graceful하게 처리

## 버그 수정
- [x] 재생목록에 영상 추가 시 현재 재생 중인 영상이 초기화되는 문제
- [x] 재생목록 순서 변경 시 현재 재생 중인 영상이 초기화되는 문제

## UI 개선 3차
- [x] CompositionModeSelector - 전체화면과 박스 크기 일치
- [x] PreviewCanvas 크기 확대 (300px)
- [x] SettingsPanel 여백 조정

## 미디어 플레이어 기능 추가
- [x] 건너뛰기 단축키 (1초, 10초, 1분, 5분)
- [x] 구간 반복 기능

## 성능 개선
- [x] Picture-in-Picture 기능 - 창 전환 시 미리보기 우선 표시

## UI 개선 4차
- [x] 미디어 플레이어 단축키 안내를 한 줄로 간결하게 정리
- [x] 자료화면 확대/축소(줌) 기능 추가

## 버그 수정 2차
- [x] 재생목록에 자료화면 추가 시 재생이 안 되는 문제 수정
- [x] 자료화면 확대/이동을 미디어 플레이어 하단으로 이동 (접기/펼치기)
- [x] 새 영상 추가 또는 다음 영상으로 변경 시 구간 반복 초기화
- [x] 구간 반복 시작점/끝점 직접 입력 기능 추가

## 성능 및 UI 개선 5차
- [x] 방송 성능 개선 (프레임레이트, 비트레이트 향상)
- [x] 건너뛰기 버튼을 한 줄로 배치
- [x] 방송 성능 기록 기능 추가
- [x] 구간 반복 시작점/끝점을 시:분:초로 분리하여 입력

## 버그 수정 3차
- [ ] 방송 시작이 안 되는 문제 수정 (확인 중)
- [x] "구간 반복"이라는 표현 명확히 하기
- [x] 구간 반복 UI를 한 줄로 정리
- [x] 자료화면 추가 시 자동 재생 안 함 (재생 버튼 눌러야 재생)
- [x] 다른 자료화면 추가해도 현재 재생 중인 영상 초기화 안 함
- [x] 재생 중인 영상이 끝나면 다음 영상 자동 재생

## 버그 수정 4차
- [x] 방송 시작이 안 되는 문제 수정 (video element 초기화 추가)
- [x] 자료화면 재생이 안 되는 문제 수정 (video element 초기화 추가)
- [x] 구간 반복 UI 개선 - 시작/끝 각각 박스로 분리 (위: 버튼, 아래: 시:분:초 입력)
- [x] 타임라인 아래에 시:분:초 입력으로 특정 시간으로 이동하는 기능 추가

## 버그 수정 5차
- [x] 게시된 사이트에서 방송 시작 버튼이 안 눌리는 문제 (mediaDevices API 체크 추가)
- [x] 방송 시작 후 응답이 없는 문제 (canvas 초기화 로그 및 알림 추가)

## 버그 수정 6차
- [x] 재생목록에서 영상 삭제 시 영상이 계속 재생되는 버그 수정
- [x] 게시된 사이트에서 방송 시작 버튼 문제 확인 (서버 기능 필요 - 정적 사이트에서는 불가)

## 기능 추가 7차
- [x] 웹캠 좌우 반전(미러링) 기능 추가

## 버그 수정 8차
- [x] PiP 창에 영상이 표시되지 않는 문제 수정
- [x] RTMP 설정 프리셋 저장 기능 추가

## 버그 수정 9차
- [ ] 게시된 사이트에서 방송 기능이 작동하지 않는 문제 분석 및 수정

## 성능 개선 10차
- [x] 비트레이트 5000kbps 이상으로 향상 (5500kbps로 설정)
- [x] 영상 끊김(껌뻑거림) 문제 해결 (ffmpeg 설정 최적화)
- [x] 스트리밍 품질 최적화 (H.264 High Profile, 48kHz 오디오)

## 성능 개선 11차
- [x] 비트레이트 문제 해결 - CBR 모드로 변경, 10Mbps 입력
- [x] 검은색 껌뻑거림 해결 - 33ms 청크, VP9 코덱, ultrafast 프리셋

## 성능 개선 12차
- [x] 껌뻑거림 문제 해결 시도 (ffmpeg 설정 최적화, -re 제거, 버퍼 설정 개선)
- [ ] GPU 가속 옵션 (서버에 GPU 없음 - 사용 불가)
- [x] 네트워크 상태 모니터링 UI 구현 (인코딩 속도, 드롭 프레임, 품질 표시)

## 성능 개선 13차
- [x] 모니터링 데이터 서버 저장 기능 구현 (stream-monitor.log)
- [x] 버퍼링/딜레이 문제 해결 (nobuffer, low_delay 설정)
- [x] 불규칙한 깜빡거림 해결 시도 (vsync drop, fps 고정)
